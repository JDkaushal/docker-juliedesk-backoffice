<%= javascript_include_tag 'automatic_templates_manager' %>
<script>
    window.drawCalendarCallback = function(){
        if(window.threadAccount) {
            window.activateCalendarWithParams({
                mode: "free_calendar",
                date_times: [],
                email: "<%= @message.messages_thread.account_email %>",
                duration: <%= @message.messages_thread.computed_data[:duration] || 60 %>
            });
        }
        else {
            $("#show-calendar-button").hide();
        }

        $(".calendar-container").addClass("minimized");
    };

    window.afterReplyBoxInitCallback = function(){
        window.setReplyMessage("", "only_client");
    };

    $(function() {
        window.templateManager = new TemplateManager({
            categories: ['follow_up_client'],
            onItemSelected: function(clickedNode, template) {
                window.setReplyMessage(template, "only_client");
            }
        });

      window.initializeEmailLanguageSelector(window.templateManager.refreshCurrentSelectedTemplate);
    });

</script>