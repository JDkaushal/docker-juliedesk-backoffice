Calendar.prototype.showEventDetails = function(event, $currentTarget) {
    var calendar = this;

    calendar.redrawEventDetailsFromEvent(event);

    // Positioning
    if($currentTarget) {
        calendar.$currentEventTarget = $currentTarget;
        var $edc = calendar.$selector.find("#event-details-container");

        if($currentTarget.offset().left < calendar.$selector.width() / 2) {
            $edc.find(".event-tile-container").css({
                top: (calendar.$selector.height() - $edc.find(".event-tile-container").outerHeight()) / 2,
                left: $currentTarget.offset().left + $currentTarget.width() + 10,
                right: "auto"
            });
        }
        else {
            $edc.find(".event-tile-container").css({
                top: (calendar.$selector.height() - $edc.find(".event-tile-container").outerHeight()) / 2,
                right: $(".fixed-columns").width() - $currentTarget.offset().left + 10,
                left: "auto"
            });
        }

    }

};

Calendar.prototype.redrawEventDetailsFromEvent = function(event) {
    var calendar = this;
    var $container = calendar.$selector.find("#event-details-container");
    calendar.currentEvent = event;
    calendar.currentEventTile = new EventTile($container, {
        timezoneId: calendar.getCalendarTimezone(),
        mode: calendar.getMode(),
        event: event,
        eventId: event.id,
        calendarId: event.calId,
        accountEmail: calendar.initialData.email,
        locale: window.threadLocale,
        selectEventCallback: function() {
            calendar.selectEvent(calendar.currentEvent);
            calendar.redrawEventDetailsFromEvent(calendar.currentEvent);
        },
        doneEditingCallback: function() {
            $container.fadeOut(200);
            calendar.refreshEvents();
        }
    });
    calendar.currentEventTile.redraw();
    calendar.$selector.find("#event-details-container").fadeIn(200);
};

Calendar.prototype.clickEventDetailsContainer = function(e) {
    var calendar = this;
    var $container = calendar.$selector.find("#event-details-container");
    var $target = $(e.target);

    if($target.closest(".event-tile-container").length == 0) {
        if(calendar.getMode() == "free_calendar") {
            calendar.addEvent(null);
        }
        $container.fadeOut(200);
    }
};